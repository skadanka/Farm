# Farm
##  שוק איכרים דוח

הקדמה:
בעבודה הזו מימשתי שוק, השוק מכיל את כל האיכרי ם שמעוניינים למכור ולקנות
בשוק מומש בעזרת ווקטור מצביעי חוות . לכל איכ ר מעוניין במוצר יחיד קבוע הניתן
מראש, כמו כן כל איכ ר בהתאם לסוג החווה שמחזיק מוכר מוצרים מסוג אחד קבוע,
למוצר זה מחיר קבוע גם כן. לאחר פתיחת השוק ושכל איכ ר הלך בדק כל איכ ר אחר,
ובמידה שהמוצר שהאיכר מעוניין בו זהה למוצר שהמוכר מוכר תתבצע המכירה
ותנתן קבלה מתאימ ה )במידה לקונה יש כסף גדול שווה ממחיר המוצר שמעוניין וגם
למוכר יש מוצרים למכור( .
כאשר כל האיכרים סיימו לקנות מוצרים, בכספם הנותר יקנו חיות , לכל איכר חיה
שמחירה קבוע, בנוסף לכל החקלאים שסוג חוותם משותף, המוצר שימכרו והחיות
שיקנו משותף בין כל סוגי החוות הללו .
כל חווה מחזיקה ווקטור השומר את כל החיות השייכות לחווה אליו יתסוופו החיות
החדשות. כמו כן בכל סגירת שוק נעדכן את כל גילאי החיות, מכיוון שגיל החיה שווה
לתפוקתה ,
נוסיף על חיה שלא הגיע לגיל העזיבה פלוס אחד לסך הגילאים בחווה,
אחרת נעזיב את החיה ונוריד את גילה )תפוקה( מסך התפוקה בחווה.
בפתיחה מחודשת התהליך מתחיל חלילה, האיכרים מעדכנים את המלא י והלאה.

Virtual Table Farm->CowsFarm & Virtual Table Animal->Cow

![image](https://user-images.githubusercontent.com/62882347/209448125-0c6e4b4d-f8e0-4dd2-a332-06f43bb71a4c.png)

![image](https://user-images.githubusercontent.com/62882347/209448135-04b69a5b-7120-41df-ae5b-785a9ea3c7f1.png)

### Observer Pattern
בקוד השתמשתי בתבנית הצופה על מנת לבדוק אם החווה מוכרת את המוצר
שאני קונה, במידה וכן תתבצע המכירה, כלומר הלקוח יכול לבצע פעולות על
המוכר.

![image](https://user-images.githubusercontent.com/62882347/209448143-1808d9f5-355a-4898-ae93-9a8da61d7fc2.png)

![image](https://user-images.githubusercontent.com/62882347/209448145-e51a4a3b-c787-4bd9-9c6c-7561c84babda.png)

דוגמא לבדיקה כי האם client הוא לקוח, נבדוק אם הקליינט קונה מה שאני
מוכר. במקרה הזה חוות הכבשים קונה חלב, וחוות הפרות מוכרת חלב.
היה השיקול להגדיר משתנה סטטי ב- Market ככה שכל איכר פותח את הבסטה
שלו בתורו, כל שאר החקלאים יראו מה נמכר כעת. ובהשוואה דומה תתבצע
המכירה. מכיוון שההדפסות הינם ספציפיות עבור כל מקרה אז שימוש
במטודות וירטאוליות על המשתנים סטטים whatIBuy, whatIsell עבור כל
תת-חווה נעשה יותר הגיוני מכיוון שאם ההדפסה בלבד היית וירטאולית עדיין
תיהיה קיימת ההנחה כי מה שאני מוכר זה מה שהקליינט קונה וזוהי תיהיה
חווה מסוג אחד קבוע הידוע מראש.
C במקום זה מה שהוגדר ושומש )כולם הוגדרו בתת-חווה למשל פה חוות
פרות(:
![image](https://user-images.githubusercontent.com/62882347/209448156-eacfd6fa-7e3c-4648-924f-f447bb713727.png)

![image](https://user-images.githubusercontent.com/62882347/209448162-dfaa0d12-2796-4373-a764-2d4a80efbd9a.png)

שימוש בפולימורפיזם ###
שני מקומות עיקרים שמתקיים בהם פולימורפיזם
במחלקת Market ווקטור ה- Bastot מחזיק את כל סוגי החוות אך מתייחס אליהן כאל
Farm כל המטיודות המתבצעות וירטואליות טהורות או נעזרות במטודות וירטאוליות
במימוש.
ב- Market נרוץ על כל החוות לפי הסדר, בעזרת nested loop נדאג שכל חווה תקנה מחווה
אחרת. נשלח כל "הוא קונה" לצאת לקניות אצל חוות "המוכר" .
בחווה:
כאשר מתבצעת קנייה של מוצרים :
- נבדוק כי הוא לקוח מתאים )הסבר ניתן קודם (
- נשאל את המוכר מה מחיר המוצר
- נתחיל לקנות ממערך המוצרים מהמדף המתאים )תא במערך (
- נעדכן את הכסף של קונה\מוכר ואת מספר המוצרים לכל אח ד
- נדפיס קבלה מתאימה
- נבדוק אם האיכר יכול להמשיך לבסטה הבאה לקנות עוד מוצרים

![image](https://user-images.githubusercontent.com/62882347/209448227-9c31a48e-cbbf-4277-b355-3f29871d1250.png)
![image](https://user-images.githubusercontent.com/62882347/209448229-e888370c-428b-4d32-bee0-1c91ac7d0f10.png)

השימוש השני בפולימורפיזם לטעמי חלקי, מכיוון שהוא נעשה בתוך חווה
כאשר ידוע כבר את סוגי החיות השייכים לחווה זו, לכן הפולימורפיזם פה אינו
הכרחי מכיוון שאת כל הפעולות שנבצע על Animal יהיה ניתן לבצע על Cow
במחלקה CowsFarm ללא תקלות, במידה והוספנו את החיות השייכות לחווה
זו בלבד.
דוגמא לשימוש נכון בפולימורפיזם, כאשר מעדכנים את גילאי כל החיות בחווה
נקרא למטודה הוירטואלית על כל חיה המעדכנת את גילה ובודקת אם החיה
הגיע לגיל הפרישה.)מחזירה ערך בוליאני(. כאן קיים חיוב להתייחס לגיל
הפרישה השונה עבור כל סוג חיה. המטודה הוירטואלית פותרת בעיה זו.
#### במחלקה של פרה:
![image](https://user-images.githubusercontent.com/62882347/209448242-b8f7dee9-adf2-4e72-b75c-7c595baeb27e.png)
#### במחלקה של חווה:
![image](https://user-images.githubusercontent.com/62882347/209448267-35668314-a52c-4a90-bef2-dcd6ec6d8a2d.png)

בנוסף מחיר המוצ ר בהתחלה היה כוונה להשיג את מחיר מוצר בדרך שהדגמתם של
Observer pattren עבור החיות. אבל במקרה הזה אנו מתחייבים שיהיה מופע של חיה אך
קיימים מקרים שאין אף חיה לשאול.
![image](https://user-images.githubusercontent.com/62882347/209448275-01774ad9-530d-454e-b7ca-32b3cc90fbe3.png)
לבסוף בחרתי בדרך לכתוב עבור כל חווה משתנה סטטי פרטי המחזיק את מחיר המוצרים של החווה הזו.
בכך נמנע מצב המותאר קודם. אין מקרה בו צריך לשאול חווה את מחיר המוצר אבל אין לנו מופע של
חווה, אין בדבר היגיון. לכן הגדרת משתנה סטטי
עבור כל חווה הרגיש פתרון טוב יותר.
![image](https://user-images.githubusercontent.com/62882347/209448279-294e41a8-7e81-4101-851d-2be5ccf89706.png)

### תהליך יצירת חווה
![image](https://user-images.githubusercontent.com/62882347/209448296-f575c066-afea-43e5-a7b1-fec0d336610f.png)

קבלת קלט מהמשתמש ובדיקה אם תקין, במידה ולא זרוק שגיאה ותתחיל את
תהליך בקשת הקלט מחדש.
![image](https://user-images.githubusercontent.com/62882347/209448302-9c7c57de-cbb5-435f-990f-3a701aead7cb.png)

הוספה של חווה לווקטור Bastot במערכת
![image](https://user-images.githubusercontent.com/62882347/209448318-d154c6ed-16f2-4e7e-b8f2-2c4d7ec4f139.png)

היכרות עם לקוחות חדשים. עוברים על הבסטות בשוק xקליינטים חדשים
בודקים אם אחד לקוח של השני ומדפיס להתאם.
![image](https://user-images.githubusercontent.com/62882347/209448323-2d836901-6fb9-4356-be5a-460b9b3e5876.png)

כל החוות מעדכנות את המלאי, שימוש במטודה השייכת ל- Farm המוסיפה
מלאי חדש המתבסס על הגילאים בחווה.
![image](https://user-images.githubusercontent.com/62882347/209448327-6b1e75e7-a91a-4139-94e0-f3f6510ea5b3.png)

שולחים כל חווה לפי תור ללכת לקנות, עד כל החוות הלכו לקנות לפחות פעם
אחת.
![image](https://user-images.githubusercontent.com/62882347/209448337-9fb69fe0-486f-42bb-990f-fb837218f181.png)

כל החוות קונות בכסף הנותר חיות השייכות לסוג החווה שלהם בעזרת מטודה
וירטואלית טהורה.
![image](https://user-images.githubusercontent.com/62882347/209448351-643dd06e-f61f-4319-b768-6454ba53f74d.png)
מוסיפים 10$ לכל חווה ומעדכנים את גילאי כל החיות השייכות לחווה.
![image](https://user-images.githubusercontent.com/62882347/209448355-0c949894-03b7-446a-96df-345111b6d559.png)

הגדרת משתנים עבור כל חווה, ידוע לכל חווה את המוצרים שמוכרת המוצרים
שקונה וגם מחיר המוצר. הגדרתם נעשית ידנית.
משתנים אלו קבועים ונתונים לאורך כל
התוכנית לכן הגדרתם נכונה לדעתי.

![image](https://user-images.githubusercontent.com/62882347/209448362-232fb176-843a-4878-84d8-2bf9606d834b.png)

אותו הסבר עבור משתנים לכל חיה.
![image](https://user-images.githubusercontent.com/62882347/209448374-0c3b3570-7676-4ad1-9c82-254af2990c09.png)

נוסיף כי המשתנים נקבעו להיות static const כי הם קבועים ומשותפים עבור
*כל* הפרות למשל בתוכנית לכן הגדרת משתנים אלו כחברים של המחלקה
חוסך במקום, במקום ליצור מופע חדש עבור כל הפרות בתוכנית.

הגדרת המטודות הסטטיות האלו
מאפשרות ביצוע פעולות בכל החוות ללא צורך במופע של חיה, מונע תקלות
נוספות, בנוסף מונע מספרים צפים, או הקצאת זיכרון נוסף עבור משתנה החוזר
על עצמו בכל התוכנית.
![image](https://user-images.githubusercontent.com/62882347/209448379-55fb133c-3890-4561-955a-6f6a9a814734.png)

חשוב להוסיף:
![image](https://user-images.githubusercontent.com/62882347/209448385-a68e7fdf-fba2-4247-9c3b-a38140609b35.png)

במחשבה שניה, המימוש היה יותר נכון ומשתמש ב- Design pattern המבוקש
בצורה מדויקת אם היה מוגדר עבור כל חווה כיצד מתמודדת אם כל סוגי
החוות, מכיוון שזו פעולה בין 2 חוות שאחת מהן לא ידוע את סוגה, לכן שימוש
במטודה מסוימת להשוואה במקרה שכן הוא לקוח, אינה שונה מהמחשבה פה.

טיפול בשגיאות
בקבלת קלט שגוי, מספר שלילי
![image](https://user-images.githubusercontent.com/62882347/209448392-0214e1b4-979f-4d06-8ae0-44e58fba0743.png)
בעיה בהקצאת זיכרון
![image](https://user-images.githubusercontent.com/62882347/209448397-e5bb5434-b564-4d41-b28f-4398b8b0431a.png)

